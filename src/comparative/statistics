import numpy as np

from src.OOP.annotations import GAF
from src.OOP.annotations import Annotation 
from src.OOP.annotations import ExperimentalAnnotation 
from src.OOP.annotations import ComputationalAnnotation
from src.OOP.annotations import CuratedAnnotation
from src.OOP.ontology import GOterm

class Statistics:
    def __init__(self, gaf, matrix, genes, terms):

        self.gaf = gaf
        self._matrix = matrix
        self._genes = genes
        self._terms = terms

    def tc_statistics(self):

        term_counts_array = np.sum(self._matrix, axis=1)

        
        print(
            f"Mean:   {np.mean(term_counts_array):.2f}\n"
            f"Median: {np.median(term_counts_array):.2f}\n"
            f"Std:    {np.std(term_counts_array):.2f}"
        )

    def ann_statistics(self):

        if not self.gaf:
            return "No GAF provided"


        genes_counts_dict = self.gaf.count_annotations_per_gene()


        counts_array = list(genes_counts_dict.values())


        cat_summary = self.gaf.count_by_category()

        return {
            "total_annotations": len(self.gaf.annotations),
            "unique_genes": len(genes_counts_dict),
            "annotations_per_gene_mean": round(np.mean(counts_array), 2),
            "annotations_per_gene_std": round(np.std(counts_array), 2),
            "category_breakdown": cat_summary
        }
