#test execution 
# Create GO terms
t1 = GOterm(ID="GO:00001", name="Term1", namespace="BP", definition="Definition 1")
t2 = GOterm(ID="GO:00002", name="Term2", namespace="BP", definition="Definition 2")
t3 = GOterm(ID="GO:00003", name="Term3", namespace="BP", definition="Definition 3")

# t1 -> t2 -> t3
graph = GOgraph()
graph.add_term(t1)
graph.add_term(t2)
graph.add_term(t3)

graph.add_edge("GO:00001", "GO:00002")  # t1 is parent of t2
graph.add_edge("GO:00002", "GO:00003")  # t2 is parent of t3

annotation_counts = {
    "GO:00001": 50,
    "GO:00002": 30,
    "GO:00003": 10
}
total_annotations = sum(annotation_counts.values())


sim = GOSimilarity(graph, annotation_counts, total_annotations)

print("IC values:")
for term in [t1, t2, t3]:
    print(f"{term.ID}: {sim.ic(term.ID):.4f}")

print("\nAncestors of GO:00003:")
ancestors_t3 = sim.ancestors(t3)
print([t.ID for t in ancestors_t3])

print("\nResnik similarity between GO:00002 and GO:00003:")
print(sim.resnik(t2, t3))

print("\nMICA between GO:00002 and GO:00003:")
mica_term = sim.mica(t2, t3)
print(mica_term.ID if mica_term else None)

print("\nLin similarity between GO:00002 and GO:00003:")
print(sim.lin_similarity(t2, t3))

''' output -->
IC values:
GO:00001: 0.5878
GO:00002: 1.0986
GO:00003: 2.1972

Ancestors of GO:00003:
['GO:00003', 'GO:00002', 'GO:00001']

Resnik similarity between GO:00002 and GO:00003:
1.0986122886681098

MICA between GO:00002 and GO:00003:
GO:00002

Lin similarity between GO:00002 and GO:00003:
0.6666666666666667 '''
